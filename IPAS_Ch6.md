# 六、網路與通訊安全：@網路安全、@通訊安全

# 1. 針對網路各層的攻擊手法：
```
實體層—線路搭接與線路私接
資料連結層—封包監聽與ARP Spoofing
網路層—Source Route、Smurf、Ping of Death 
連線層—SYN Flood、DDoS及Session Hijacking
應用層—DNS Poisoning、Brute force Login、SQL Injection及Cross-Site Scripting
```
## (1)實體層
```
>>> 攻擊方式：
搭接線路(網路與電話)進行訊號竊聽、私接線路變成隱匿通道(非控管中的線路)
>>> 防護建議：
機房、機櫃、線路室及管道間進行存取控管、採用不同顏色區隔不同網段(安全區域)、定期的線路盤查
```
## (2)a.資料連結層_封包監聽
```
透過工具或軟體被動蒐集Collision Domain中的網路封包
>>> 監聽工具：
>* Sniffer, MailSnarf
>* URLSnarf, WebSpy
>* Tcpdump ,Windump
>* Wireshark(Ethereal)
>* Ettercap
>>> 防護建議：
>* 採用加密連線(最佳方法)
>* 改用Switch
>* 網路線路的實體存取控制，避免搭接或私接問題
```
## (2)b.資料連結層_ARP Spoofing
```
ARP(Address Resolution Protocol)用來對應MAC與IP位址的協定
又稱為ARP flooding、ARP poisoning或ARP Poison Routing
在Broadcast Domain下無法被動監聽其他電腦間連線封包
ARP Spoofing攻擊強迫偽冒其他IP，讓攻擊者有機會監測到其他電腦間的通訊
>>> 攻擊手法：
攻擊者使用ARP Broadcast封包告訴其他電腦，192.168.1.1的MAC是Attacker的MAC
其他電腦要傳送給192.168.1.1的封包會被送到Attacker
Attacker將封包錄下後轉送到真正的192.168.1.1
>>> 防護建議：
強制使用靜態ARP Table(小型網路)
採用VLAN縮小Broadcast Domain的範圍
啟用Switch中的Port、MAC及IP的對應控管
```
## (3)a.網路層_Source Route
```
IP封包的路由通常是由Router所決定，啟用Source Route可以讓傳送者指定IP封包的傳送路徑
攻擊者運用Source Route的功能進行來源IP的偽冒(IP Spoofing)
讓偽冒來源IP的封包可照指定路徑送到目的伺服器、FW信任偽冒的來源IP未加以阻擋
防護建議：在防火牆或路由器上阻擋採用Source Route的封包
```
## IP Spoofing與ARP Spoofing
```
IP Spoofing使用偽造的來源位址來傳送IP封包，可能會採用受信任來源的IP 位址來嘗試規避防火牆
ARP Spoofing是指攻擊者取得區域網路上的資料封包甚至篡改封包，可讓網路上特定電腦或所有電腦無法正常連線
```
## (3)b.網路層_Smurf Attack：藉由ICMP封包塞爆受害者網路頻寬的阻斷服務攻擊
```
>>> 攻擊手法：
攻擊者(Attacker)偽冒受害者IP(Victim)發送大量Echo Request給B網段的Broadcast IP位址(B.255或B.0)
B網段所有電腦收到Echo Request封包，都回覆Echo Reply封包給Victim
導致Victim端頻寬被大量的Echo Reply封包所占用
>>> 防護建議：
在防火牆或路由器上阻擋Network/Broadcast IP的傳送
```
## (3)c.網路層_Ping of Death：屬於一種阻斷服務攻擊，只要一個Ping封包就讓作業系統當機
```
>>> 攻擊手法：
一般正常的Ping封包大小為56位元(含IP標頭為84位元)
攻擊者故意傳送一個大小超過65536位元的Ping封包給受害者(IP協定允許封包大於65536)
受害作業系統無法處理大於65536位元的Ping封包，導致系統當機或重新開機
攻擊者的來源IP經常是偽冒的IP位址
>>> 防護建議：
修補作業系統弱點(目前大部份作業系統都已修補這個弱點)
```
## (4)a.連線層_SYN Flood
```
>>>　攻擊手法：
攻擊者傳送大量的TCP SYN請求封包到受害伺服器
受害伺服器為每一個連線請求分配系統記憶體資源，導致系統連線資源被耗用殆盡，正常的連線無法建立
大量惡意的TCP SYN封包，其來源IP通常也都是偽冒的，因此無法以封鎖來源IP阻擋攻擊
>>> 防護建議：
防火牆限制同來源IP的連線數量
請求ISP協助
```
## (4)b.連線層_分散式阻斷服務攻擊：(Distributed Denial-of-Service，簡稱DDoS)
```
>>> 攻擊手法：
攻擊者控制多部阻斷服務攻擊主機(DoS Agent)，對受害者發動大規模的阻斷服務攻擊
被攻擊的受害者為主要受害者，被控制的阻斷服務攻擊主機本身也是次要的受害者
其攻擊來源IP太多(數百至數千個)，通常很難透過防火牆封鎖來源IP
>>>　防護建議：
防火牆限制同一來源IP的連線數量
請求ISP協助
>>>　案例：
巴哈姆特遭大陸駭客DDoS攻擊
```
## (4)c.連線層_Session Hijacking
```
>>> 可分為兩種類型：
主動型：攻擊者取代已建立之有效的連線
被動型：攻擊者攔截連線後只監聽連線內容
>>> 攻擊的步驟：
追蹤連線過程
連線去同步化
注入攻擊者的封包
>>> 防護建議：
採用IPSec或SSL雙向認證的加密連線
當攻擊者可以預測到Client下一個封包的序號時，就可以偽冒Client的IP送出封包給Server，達到攔截連線的攻擊
```
## (5)a.應用層_DNS Poisoning
```
攻擊者藉由DNS伺服器的弱點，將錯誤的名稱解析植入DNS伺服器的快取區(Cache)中，導致DNS用戶端解析到錯誤的IP，使網路連線被導到惡意的伺服器
>>> 防護建議：
修補已知的DNS伺服器弱點
區隔外部與內部DNS伺服器(不要forward到ISP的DNS)
```
## (5)b.應用層_Brute force Login
```
>>> 攻擊者透過通行碼猜測入侵應用系統的狀況相當常見，例如：
TELNET login
SSH login
FTP login
SMTP AUTH
POP3 login
>>>　網路上有相當多的工具可自動進行通行碼猜測攻擊：
Brutus
THC-Hydra
>>> 防護建議：
限制同一帳戶連續簽入失敗之次數，若超過次數則延遲簽入一段時間或關閉帳號，發出警告訊息
強制使用者通行碼長度與複雜度
定期更換通行碼
```
## (5)c.應用層_SQL Injection
```
>>> 簡介：
攻擊者可以將惡意之SQL指令插入程式碼的SQL指令中
Blind SQL Injection：SQL指令注入後只回傳某些狀態，無法得知資料內容
SQL指令注入的弱點發生在Web應用程式中，但受到損害的卻是其後端的資料庫
>>> 可能的損壞：
資料庫之資料外洩、資料庫內容被修改、執行資料庫管理、網站權限跳脫或植入後門程式
>>> 弱點原理：
Web應用程式將「不可信任來源」的資訊直接組合成SQL指令後執行，就會產生SQL指令注入弱點
>>> 防護建議：
網站應用程式源碼檢測與資料輸出至資料庫前過濾SQL指令使用之特殊符號(例如：單引號與分號等)或採參數化查詢語句
```
## (5)d.應用層_Cross-Site Scripting
```
>>> 簡介：
簡稱XSS
攻擊者可透過XSS弱點將惡意腳本(例如：JavaScript與VBScript)置入Web伺服器
當其他使用者瀏覽到被置入惡意腳本的網頁時，使其瀏覽器執行惡意腳本
可區分為儲存型(Stored XSS)與反應型(Reflected XSS)兩類
>>> 可能的損壞：
機密資訊被竊取(例如：Cookie與Session ID等)
下載後門程式植入偽冒資訊
>>> 弱點原理：
Web應用程式將「不可信任來源」的資訊直接輸出至網頁或其他輸出標的就會產生XSS弱點
>>> 防護建議：
網站應用程式源碼檢測與資料輸出時做HTML特殊符號的過濾
```
# 2.從SWIFT通訊系統來看網路安全：
>* 遠東銀行SWIFT遭駭事件是臺灣首例，創下臺灣銀行遭駭盜轉金額新紀錄
>* 全球金融機構通用的SWIFT通訊系統是銀行間交易中交換結構化的電子訊息的平臺，處理支付和交易結算等商業流程
>* 駭客利用SWIFT系統的漏洞，或網路進行攻擊，來取得SWIFT系統的操作權限，植入惡意程式，將該銀行的資金轉出
>* SWIFT要求會員銀行遵守多項強制控制措施，並自2018年起對會員銀行進行稽核

# 3.網路安全防禦系統；
## (1)防火牆系統：
```
>>> 主要用途：
區隔不同安全等級網段(例如：外部網路、內部網路及DMZ)
偵測與阻擋網路層與連線層的攻擊
落實網路存取政策
>>>　防火牆類型：
封包過濾型：只判別封包的IP與埠號，規則設定複雜(Linux IP tables與路由器內建的IP access list)
連線過濾型：連線層控管技術，會掌握TCP/UDP的連線狀態
應用代理型：可控管應用層協定，例如：FTP GET/PUT，確保連線協定正常使用
連線狀態檢查型：動態的封包過濾技術，並且掌握連線各層的狀態，可兼顧效能與安全性
>>> 部署架構建議：
公開服務伺服器應置於DMZ網段
其他重要伺服器置於內部網段
關閉Source Route、關閉外部回應Ping的功能、關閉外部對防火牆本身的Telnet、SSH、SNMP、HTTP及HTTPS等管理功能
啟用DoS防護(例如：Ping of Death、Teardrop、SYN Flood及IP Spoofing等功能)
內部對外部的連線應控管，不應全面開放(例如：HTTP與SMTP等)
```
## ※ 補充：防火牆系統
```
>>> 管理重點：
防火牆存取規則的變更應建立管理程序(變更申請、核准及記錄)
防火牆存取紀錄應即時匯出存檔，並保留足夠的時間
定期產出異常存取統計分析報表，進行異常處理
防火牆存取控管規則應定期盤查(每年)
>>> 選購時重要規格：
防火牆本身的安全性(可參考Common Criteria EAL認證) 、可區隔的網路區段數應符合組織需求(外、內及DMZ) 、可支援的傳輸頻寬大小符合組織需求
應可支援阻斷服務攻擊的偵測與防護
```
## (2)入侵偵測與防禦系統：
```
>>> 主要用途：
識別網路的異常行為與攻擊行為(注意：SSL加密連線的內容無法識別)
特定無誤判之攻擊行為可以立即阻擋
>>> 入侵偵測與防禦系統類型：
/1/特徵碼比對:
比對攻擊特徵碼、判斷較精準
只能偵測已知攻擊
/2/異常行為模式分析:
統計分析
較易誤判
能偵測未知類型攻擊
>>> 入侵偵測的反應方式：
被動方式：只將異常事件記錄下來，供日後稽核分析使用
主動方式：立即將攻擊事件或攻擊來源進行封鎖
>>> 入侵偵測的部署
監聽模式：不影響網路部署，但防禦效果較差
Bridge模式：防禦能力較強可以阻擋TCP/UDP類的攻擊
主要偵測DMZ與內部網段進出口
```
## ※ 補充：入侵偵測與防禦系統
```
>>> 管理重點：
入侵行為特徵碼應隨時更新
入侵偵測之異常事件應定期分析(每週)，或委由資安監控中心隨時監控
入侵偵測存取紀錄應即時匯出存檔，並保留足夠的時間
>>> 選購時重要規格：
可偵測的網路區段數應符合組織需求(內與DMZ)
可支援的頻寬大小符合組織現有網路狀況
```
# 4.虛擬私有網路系統
```
>虛擬私有網路(Virtual Private Network，簡稱VPN)主要用途：
-在公開的網路上建立私有的安全通道
-包含身分鑑別與加密以保護通訊資料的完整性與機密性
>VPN的類型：
-遠端使用者存取VPN：外勤人員透過網際網路與內部網路建立的安全通道
```
>* Site-to-Site VPN：總部與分點之內部網路透過網際網路建立安全通道
>* Extranet VPN：與合作伙伴間透過網際網路建立安全通道(注意存取權限的控管)
```
>使用VPN的好處(與實體私有網路比較)：
-部署較彈性
-可擴充性較高
-線路成本較低
>VPN協定：
-PPTP：適用於遠端使用者存取的VPN
-L2TP：適用於遠端使用者存取的VPN
-SSL：適用於遠端使用者存取的VPN(好處是不必裝任何用戶端軟體，只要有瀏覽器即可)
-IPSec：適用於遠端使用者存取VPN、Site-to-Site VPN及Extranet VPN
**目前大部份防火牆產品已內建VPN功能
```
## ※ 虛擬私有網路系統
```
>管理重點：
-虛擬私有網路的建立與使用者帳號的申請，應建立管理程序(變更申請、核准及記錄)
-定期分析異常事件，例如：VPN使用者簽入失敗
-VPN存取紀錄應即時匯出存檔，並保留足夠的時間
>選購時重要規格：
-可支援的VPN數量或使用者連線數量應滿足組織需求
-本身應具備防火牆功能，以控管VPN連線的存取
-與其他不同廠牌產品建立VPN連線的相容性
```
# 5.防毒系統
```
>主要用途：
-防止病毒、蠕蟲、間諜、後門及木馬等惡意程式入侵電腦系統
>惡意程式的來源：
-電子郵件
-USB硬碟
-網站瀏覽
-即時通訊
-檔案傳輸/分享
>全面防毒的部署：
-個人電腦與伺服器防毒
-電子郵件防毒匣道
-上網防毒匣道
```
```
>管理重點：
-應定期自動更新病毒碼
-病毒感染的事件與趨勢應定期分析
-避免未安裝防毒軟體的電腦上線(配合NAC設備)
-防火牆控管未經防毒匣道過濾的連線行為
-「個人電腦與伺服器防毒系統」與「防毒匣道系統」可採用不同廠牌
>選購時之重要規格：
-病毒偵測的精準度、對電腦效能的影響
-是否提供中央控管機制
-可支援的網路連線偵測能力(電子郵件與即時通訊)
```
# 6.垃圾郵件過濾系統
```
>主要用途：
-過濾垃圾與廣告郵件
-避免電子郵件社交工程攻擊
-提升人員電子郵件使用安全
>垃圾郵件的判斷技術：
-連線模式(RBL、DNS反查、SPF及DomainKey等)
-關鍵字比對(中文字，包含附件)
-內容過濾條件
-外部資料庫比對(DCC、Razor、Pyzor)
-貝氏演算法(自動學習機制)
-圖片辨識技術
```
```
>部署方式：
-匣道模式(Mail Relay)
**不影響其他網路流量
**設備故障時信件無法進出
**安全性高(Fail Close)
-Bridge模式(目前較少見)
**會影響其他網路流量
**設備故障時會自動Bypass流量
**安全性較低(Fail Open)
```
## ※ 垃圾郵件過濾系統
```
>管理重點：
-應定期自動更新垃圾郵件辨識特徵碼
-電子郵件過濾規則的變更應建立管理程序(變更申請、核准及記錄)
>選購時之重要規格：
-垃圾郵件判斷的精準度
-處理效能可符合組織需求
-對於中文信件或多國語言的支援能力
-全文檢索支援中文的能力與郵件附件的檢索能力
-圖片廣告信件的支援能力
```
